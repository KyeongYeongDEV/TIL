## 1. 컨텍스트 스위칭이란?

- **정의**: CPU가 실행 중인 프로세스(또는 스레드)의 상태(Context)를 저장하고, 다른 프로세스의 상태를 복원하여 실행을 전환하는 과정.
- Context = **레지스터 값, 프로그램 카운터, 스택 포인터, 메모리 맵 정보, CPU 상태 레지스터** 등.

---

## 2. 컨텍스트 스위칭 시 일어나는 일

1. 현재 실행 중인 프로세스의 **레지스터, 프로그램 카운터, 스택 포인터 등 상태 저장**
    
    → **PCB(Process Control Block)** 또는 **TCB(Thread Control Block)**에 저장
    
2. 스케줄러가 다음에 실행할 프로세스를 선택
3. 선택된 프로세스의 상태를 PCB/TCB에서 읽어 CPU 레지스터에 복원
4. 해당 프로세스의 명령어 주소부터 실행 재개

---

## 3. 프로세스 vs 스레드 컨텍스트 스위칭 차이

| 구분 | 프로세스 스위칭 | 스레드 스위칭 |
| --- | --- | --- |
| 주소 공간 | 서로 다른 메모리 공간 → **MMU(메모리 맵) 변경 필요** | 같은 주소 공간 공유 |
| 비용 | 높음 (캐시 flush, 페이지 테이블 교체) | 낮음 (레지스터·스택만 교체) |
| PCB 저장 정보 | 레지스터, PC, 스택, 페이지 테이블, 파일 핸들 등 | 레지스터, PC, 스택 |

---

## 4. 커널 스택에 저장되는 형식

- **커널 스택**은 각 프로세스/스레드마다 별도 존재
- 컨텍스트 스위칭 시 저장되는 주요 정보:
    1. CPU 레지스터 값 (일반 레지스터, 상태 레지스터)
    2. 프로그램 카운터(PC)
    3. 스택 포인터(SP)
    4. 시스템 호출 시 필요한 커널 내부 데이터
- 이런 정보들이 **스택 프레임(Stack Frame)** 형태로 쌓임

---

## 5. 컨텍스트 스위칭이 발생하는 시점

- **타이머 인터럽트** (할당 시간 초과 → Preemptive 스케줄링)
- **I/O 요청** (CPU 대기 → 다른 프로세스 실행)
- **시스템 호출** (예: `sleep()` → CPU 양보)
- **우선순위 높은 프로세스 도착** (선점형 스케줄링)

---

# 대답

**Q. 컨텍스트 스위칭 시에는 어떤 일들이 일어나나요?**

> 컨텍스트 스위칭은 현재 CPU를 쓰고 있는 작업의 상태를 저장하고, 다른 작업의 상태를 복원해서 실행을 전환하는 과정입니다.
> 
> 
> 레지스터 값, 프로그램 카운터, 스택 포인터 같은 정보가 PCB나 TCB에 저장되고, 새로운 작업의 상태를 불러와 CPU에서 이어서 실행합니다.
> 

---

**Q. 프로세스와 스레드는 컨텍스트 스위칭 시 어떤 차이가 있나요?**

> 프로세스 전환은 주소 공간이 달라서 페이지 테이블 교체나 캐시 초기화가 필요해 비용이 큽니다.
> 
> 
> 스레드 전환은 같은 주소 공간을 공유하므로 레지스터와 스택만 바꾸면 돼서 상대적으로 빠릅니다.
> 

---

**Q. 컨텍스트 스위칭 시 기존 프로세스 정보는 커널 스택에 어떤 형식으로 저장되나요?**

> 각 프로세스는 자신만의 커널 스택을 가지고 있고, 그 안에 레지스터 값, 프로그램 카운터, 스택 포인터 등이 스택 프레임 형태로 저장됩니다.
> 

---

**Q. 컨텍스트 스위칭은 언제 일어나나요?**

> 대표적으로 타이머 인터럽트로 CPU 할당 시간이 끝났을 때, I/O 대기로 멈췄을 때, 시스템 호출로 CPU를 양보할 때, 더 높은 우선순위의 작업이 도착했을 때 발생합니다.
> 

---
